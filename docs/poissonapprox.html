<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>When can Poisson Regression approximate Logistic?</title>
    <link rel="stylesheet" href="style.css">
    <!-- Mathjax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <!-- Polyfill needed only for IE11 -->
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <!-- /Mathjax -->
    <script src="toc.js"></script>
  </head>
<body class="statsnotes">
  <div>
    <section id="introduction">
      <h1>When can Poisson Regression approximate Logistic?</h1>
      <p>
        An older idea in Epidemiology is to use a Poisson regression model in
        place of a logistic regression model. This idea has some validity
        because with a low mean, the Poisson distribution approximates the
        binary distribution.
      </p>
    </section>
    <section id="simulation">
      <h2>Simulation</h2>

      <p>
        Let’s examine this. First, we define a program which generates some data
        according to a logistic model, then fits both logistic and Poisson
        regression models against it.
      </p>

      <p>
        This program, defined below, takes in three arguments:
      </p>

      <ul>
        <li><code>n</code> - Sample size</li>
        <li><code>p</code> - Baseline probability of success</li>
        <li><code>b1</code> - Coefficient of interest.</li>
      </ul>

      <p>
        The model is simply
      </p>

      \[
      logit(P(Y = 1 | X)) = logit(p) + b_1x
      \]

      <pre>program def binsim, rclass
    drop _all
    args n p b1
    set obs `n'
    gen x = rnormal()
    gen y = rbinomial(1, invlogit(logit(`p') + `b1'*x))
    * Return P(success) to ensure everything is working
    mean y
    mat b = e(b)
    scalar pp = b[1,1]
    return scalar pp=pp

    * Poisson model
    poisson y x
    mat b = e(b)
    scalar b_pois = b[1,1]
    return scalar b_pois=b_pois

    * Logistic model
    logistic y x
    mat b = e(b)
    scalar b_logit = b[1,1]
    return scalar b_logit=b_logit
end</pre>

    </section>
    <section id="results">
      <h2>Results</h2>
      <p>
          Now we can run it with a few different settings. Specifically, we’re
          interested in how close to 0 the mean must be for the Poisson
          coefficient to approximate the logistic coefficient.
      </p>

        <div class="tabset-margin-container"></div>
        <div class="panel-tabset">
          <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item" role="presentation">
              <a
                class="nav-link active"
                id="tabset-1-1-tab"
                data-bs-toggle="tab"
                data-bs-target="#tabset-1-1"
                role="tab"
                aria-controls="tabset-1-1"
                aria-selected="true"
                >10% success</a
              >
            </li>
            <li class="nav-item" role="presentation">
              <a
                class="nav-link"
                id="tabset-1-2-tab"
                data-bs-toggle="tab"
                data-bs-target="#tabset-1-2"
                role="tab"
                aria-controls="tabset-1-2"
                aria-selected="false"
                >5% success</a
              >
            </li>
            <li class="nav-item" role="presentation">
              <a
                class="nav-link"
                id="tabset-1-3-tab"
                data-bs-toggle="tab"
                data-bs-target="#tabset-1-3"
                role="tab"
                aria-controls="tabset-1-3"
                aria-selected="false"
                >3% success</a
              >
            </li>
            <li class="nav-item" role="presentation">
              <a
                class="nav-link"
                id="tabset-1-4-tab"
                data-bs-toggle="tab"
                data-bs-target="#tabset-1-4"
                role="tab"
                aria-controls="tabset-1-4"
                aria-selected="false"
                >1% success</a
              >
            </li>
          </ul>
          <div class="tab-content">
            <div
              id="tabset-1-1"
              class="tab-pane active"
              role="tabpanel"
              aria-labelledby="tabset-1-1-tab"
              >

              <pre></pre>

              <p>
                First we’ll ensure the code is working and that P(success) is
                10% as requested.
              </p>

              <pre></pre>

              <p>Now we can look at the kernel densities</p>

              <pre></pre>

              <p><img src="graphs/poisson1.svg" class="img-fluid" /></p>
              <p>
                The Poisson coefficient is strongly negatively biased. We can
                estimate the bias as a percent of the true coefficient.
              </p>

              <pre></pre>

              <div
              id="tabset-1-2"
              class="tab-pane"
              role="tabpanel"
              aria-labelledby="tabset-1-2-tab"
                >

                <pre></pre>

              <p><img src="graphs/poisson2.svg" class="img-fluid" /></p>
              <p>Still see a negative bias.</p>
            </div>
            <div
              id="tabset-1-3"
              class="tab-pane"
              role="tabpanel"
              aria-labelledby="tabset-1-3-tab"
            >

              <pre></pre>

              <p><img src="graphs/poisson3.svg" class="img-fluid" /></p>
              <p>The bias is minimal but still present.</p>
            </div>
            <div
              id="tabset-1-4"
              class="tab-pane"
              role="tabpanel"
              aria-labelledby="tabset-1-4-tab"
            >

              <pre></pre>

              <p><img src="graphs/poisson4.svg" class="img-fluid" /></p>
              <p>The bias has all but disappeared.</p>
            </div>
          </div>
      <section id="conclusion">
        <h2>Conclusion</h2>
        <p>
          I wouldn’t recommend using Poisson over Logistic unless P(Success) was
          1% or less.
        </p>
        <p>
          There’s an interesting artifact to explore, namely that the percent
          bias is consistently about 15-20% larger than the true beta.
        </p>
      </section>
    </section>
  </div>
</body>
    <p style="text-align:center">
      <a href="https://errickson.net">Home</a> | <a href="https://errickson.net/stats-notes">Back</a>
    </p>
	</nav>

</body>
</html>
